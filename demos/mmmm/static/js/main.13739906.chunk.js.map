{"version":3,"sources":["session.js","mind.js","mind.layout.js","mind.view.js","MindMap.js","App.js","serviceWorker.js","index.js"],"names":["Session","this","undos","redos","current","completed","Subject","Error","from","to","begin","entry","pop","actions","forEach","x","push","message","next","_assertNotInTransaction","_assertInTransaction","length","_replay","action","unshift","Entity","text","modified","_text","value","old","root","session","record","_setText","Item","parent","id","marginX","marginY","children","json","Items","_newID","_marginX","_marginY","_setParent","_setMarginX","_setMarginY","Object","assign","undefined","toJSON","_items","indexOf","i","index","_splice","items","at","isAncestorOf","remove","_add","collapsed","map","_collapsed","add","removed","splice","item","Symbol","iterator","Root","nextID","left","right","_nextID","_setNextID","EntityLayout","last","model","subscription","subscribe","_dirty","width","nextWidth","height","nextHeight","focused","BehaviorSubject","anchored","selected","ItemLayout","ItemsLayout","top","Math","min","bottom","max","unsubscribe","_dispose","closed","_detach","dx","_moveX","dy","_moveUpTop","_moveUpBottom","_moveDownTop","_moveDownBottom","_moveY","_selectClear","y","entity","RootLayout","lasts","Map","Array","get","delete","values","n","y0","find","name","selecteds","reduce","__moveUpTop","__moveDownBottom","selectClear","findIndex","_current","_getCurrent","_path","_find","_setCurrent","d","first","path","xs","path0","path1","shift","select","depth","selectSet","partial","range","j","partial0","partial1","View","layout","mindlayout","translate","scale","editorDefault","input","editor","cancel","commit","menu","faUndo","_editorCommitAnd","undo","faRedo","redo","manipulator","faTimes","faCheck","edit","collapse","faExpandArrowsAlt","faCompressArrowsAlt","faEdit","faPlusSquare","_withTransaction","selectByModel","menus","faTrash","faArrowsAlt","moveElsewhere","tree","_kick","pipe","of","queueScheduler","exhaust","dispose","control","anchor","selectRange","x0","pan","moved","move","x1","y1","cx","cy","ratio","s0","s1","r","end","s","found","moveInto","t","direction","yy","xx","Manipulatee","React","forwardRef","ref","cursor","onPointerDown","props","useState","setManipulator","style","e","preventDefault","stopPropagation","currentTarget","setPointerCapture","pointerId","onPointerUp","releasePointerCapture","onPointerMove","MindMapContext","createContext","useEntity","setFocused","setSelected","useRef","useLayoutEffect","nextSize","offsetWidth","offsetHeight","context","useContext","setEditor","inputRef","focus","innerText","selection","window","getSelection","removeAllRanges","selectAllChildren","position","contentEditable","className","onInput","target","onBlur","onKeyDown","key","transform","shiftKey","ctrlKey","clientX","clientY","onClick","title","xmlns","viewBox","Menu","icon","fixedWidth","MindMap","setRoot","setCurrent","setTranslate","setScale","setMenus","useEffect","rootRef","viewport","setViewport","viewportRef","observer","ResizeObserver","getBoundingClientRect","observe","disconnect","indicator","setIndicator","menuRef0","menuRef1","menuRef2","menuRef3","menuRef4","menuRef5","menuRef6","menuRef7","menuTransforms","setMenuTransforms","sx","sy","mx","my","clear","onWheel","zoom","deltaY","onScroll","scrollLeft","scrollTop","scroll","transformOrigin","App","setModel","fileID","setFileID","navigate","history","replaceState","location","origin","pathname","a","GAPI","gapi","parseState","mind","JSON","download","parse","view","setView","mindview","uploadRef","downloadRef","setMenu","faFile","faCloudDownloadAlt","pickFile","buildState","faCloudUploadAlt","stringify","update","pickFolder","folderID","create","faFileUpload","click","faFileDownload","type","display","onChange","files","href","encodeURIComponent","Provider","Boolean","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console"],"mappings":"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","file":"static/js/main.13739906.chunk.js","sourcesContent":["import { Subject } from 'rxjs';\n\n/**\n * 操作の履歴を管理する機能を提供します。\n * @module session\n */\n\n/**\n * @file\n * @example\n * const session = new Session();\n * let x = 0;\n * function change(x1) {\n *   if (x1 === x) return;\n *   const x0 = x;\n *   session.record(() => change(x0));\n *   x = x1;\n * }\n * session.begin();\n * try {\n *   change(1); // x -> 1;\n *   session.commit('x を変更。');\n * } catch {\n *   session.cancel();\n * }\n * session.undo(); // x -> 0;\n * session.redo(); // x -> 1;\n */\n\n/**\n * 記録対象の操作を表します。\n * @callback Action\n */\n\n/**\n * トランザクションを表します。\n * @typedef Transaction\n * @property {string} message 確定時のメッセージ。\n * @property {!module:session~Action[]} actions 記録された操作の一覧。\n */\n\n/**\n * 操作の履歴を管理します。\n */\nexport class Session {\n  _assertInTransaction() {\n    if (this.current === null) throw new Error('must be in transaction');\n  }\n  _assertNotInTransaction() {\n    if (this.current !== null) throw new Error('must not be in transaction');\n  }\n  _replay(from, to) {\n    this.begin();\n    const entry = from.pop();\n    entry.actions.forEach(x => x());\n    to.push({message: entry.message, actions: this.current});\n    this.current = null;\n    this.completed.next();\n  }\n\n  /**\n   * セッションを初期化します。\n   */\n  constructor() {\n    /**\n     * 元に戻す用トランザクションの一覧。\n     * @readonly\n     * @type {!module:session~Transaction[]}\n     */\n    this.undos = [];\n    /**\n     * やり直し用トランザクションの一覧。\n     * @readonly\n     * @type {!module:session~Transaction[]}\n     */\n    this.redos = [];\n    /**\n     * 実行中のトランザクション(に記録された操作の一覧)。\n     * @readonly\n     * @type {?module:session~Action[]}\n     */\n    this.current = null;\n    /**\n     * トランザクションの完了(確定/中止/元に戻す/やり直し)を表すサブジェクト。\n     * @readonly\n     * @type {!module:rxjs.Subject}\n     */\n    this.completed = new Subject();\n  }\n  /**\n   * トランザクションを開始します。\n   */\n  begin() {\n    this._assertNotInTransaction();\n    this.current = [];\n  }\n  /**\n   * トランザクションを確定します。\n   * @param {string} message メッセージ。\n   */\n  commit(message) {\n    this._assertInTransaction();\n    this.redos.length = 0;\n    this.undos.push({message: message, actions: this.current});\n    this.current = null;\n    this.completed.next();\n  }\n  /**\n   * トランザクションを中止します。\n   */\n  cancel() {\n    this._assertInTransaction();\n    const actions = this.current;\n    this.current = [];\n    actions.forEach(x => x());\n    this.current = null;\n    this.completed.next();\n  }\n  /**\n   * トランザクションの履歴をクリアします。\n   */\n  clear() {\n    this._assertNotInTransaction();\n    this.undos.length = this.redos.length = 0;\n  }\n  /**\n   * 直前のトランザクションを元に戻します。\n   */\n  undo() {\n    this._replay(this.undos, this.redos);\n  }\n  /**\n   * 元に戻した最後のトランザクションをやり直します。\n   */\n  redo() {\n    this._replay(this.redos, this.undos);\n  }\n  /**\n   * 元に戻す操作を記録します。\n   * @param {!module:session~Action} action 元に戻す操作。\n   */\n  record(action) {\n    this._assertInTransaction();\n    this.current.unshift(action);\n  }\n}\n\nexport default Session;\n","import { Subject } from 'rxjs';\n\n/**\n * マインドマップのモデルを提供します。\n * @module mind\n */\n\n/**\n * @file\n * @example\n * const session = new Session();\n * const root = new Root(session, json0);\n * session.begin();\n * try {\n *   root.text = 'foo';\n *   session.commit('ルートのテキストを変更。');\n *   const json1 = root.toJSON();\n * } catch {\n *   session.cancel();\n * }\n */\n\n/**\n * ルートを含む各項目に共通の実体を表します。\n */\nclass Entity {\n  _setText(value) {\n    const old = this._text;\n    this.root.session.record(() => this._setText(old));\n    this._text = value;\n    this.modified.next();\n  }\n\n  /**\n   * ルート。\n   * @memberof module:mind~Entity\n   * @instance\n   * @readonly\n   * @member {!module:mind.Root} root\n   */\n\n  constructor({text}) {\n    /**\n     * 実体が変更されたことを表すサブジェクト。\n     * @readonly\n     * @type {!module:rxjs.Subject}\n     */\n    this.modified = new Subject();\n    this._text = text || '';\n  }\n  toJSON() {\n    return {text: this._text};\n  }\n  /**\n   * テキスト。\n   * @type {!string}\n   */\n  get text() {\n    return this._text;\n  }\n  set text(value) {\n    if (value !== this._text) this._setText(value);\n  }\n}\n\n/**\n * 項目の JSON 形式を表します。\n * @typedef ItemJSON\n * @property {string} text テキスト。\n * @property {module:mind~ItemsJSON} children 子のツリー。\n */\n\n/**\n * ルート以外の項目を表します。\n * @extends module:mind~Entity\n */\nclass Item extends Entity {\n  _setParent(value) {\n    const old = this.parent;\n    this.root.session.record(() => this._setParent(old));\n    this.parent = value;\n  }\n  _setMarginX(value) {\n    const old = this._marginX;\n    this.root.session.record(() => this._setMarginX(old));\n    this._marginX = value;\n    this.modified.next();\n  }\n  _setMarginY(value) {\n    const old = this._marginY;\n    this.root.session.record(() => this._setMarginY(old));\n    this._marginY = value;\n    this.modified.next();\n  }\n\n  constructor(parent, {id, marginX, marginY, children, ...json}) {\n    super(json);\n    this.root = parent.parent.root;\n    /**\n     * 親の項目一覧。\n     * @readonly\n     * @type {!module:mind~Items}\n     */\n    this.parent = parent;\n    /**\n     * 子のツリー。\n     * @readonly\n     * @type {!module:mind~Items}\n     */\n    this.children = new Items(this, children);\n    /**\n     * 識別番号。\n     * @readonly\n     * @type {number}\n     */\n    this.id = typeof id === 'number' ? id : this.root._newID();\n    this._marginX = marginX || 0.0;\n    this._marginY = marginY || 0.0;\n  }\n  toJSON() {\n    return Object.assign(super.toJSON(), {\n      id: this.id,\n      marginX: this._marginX !== 0.0 ? this._marginX : undefined,\n      marginY: this._marginY !== 0.0 ? this._marginY : undefined,\n      children: this.children.toJSON()\n    });\n  }\n  /**\n   * 親の一覧内でのインデックス。\n   * @readonly\n   * @type {number}\n   */\n  get index() {\n    return this.parent._items.indexOf(this);\n  }\n  /**\n   * 自身を削除します。\n   */\n  remove() {\n    const i = this.index;\n    this.parent._splice(i, 1);\n    const items = this.parent._items;\n    if (i < items.length) items[i].marginY += this._marginY;\n    return i;\n  }\n  /**\n   * 自身が items の上位か否かを判定します。\n   * @param {!module:mind~Items} items 判定対象の項目一覧。\n   * @returns {boolean}\n   */\n  isAncestorOf(items) {\n    let x = items.parent;\n    while (x instanceof Item) {\n      if (x === this) return true;\n      x = x.parent.parent;\n    }\n    return false;\n  }\n  /**\n   * 自身を items の at 番目に移動します。\n   * @param {!module:mind~Items} items 移動先の項目一覧。\n   * @param {number} at 移動先のインデックス。\n   */\n  moveInto(items, at) {\n    if (this.isAncestorOf(items)) throw new Error('cannot move into self');\n    const i = this.remove();\n    this.marginY = 0.0;\n    if (items === this.parent) {\n      if (at > i) --at;\n    } else {\n      this._setParent(items);\n    }\n    items._add(at, this);\n  }\n  /**\n   * X 軸方向の親とのマージン。\n   * @type {number}\n   */\n  get marginX() {\n    return this._marginX;\n  }\n  set marginX(value) {\n    if (value < 0.0) value = 0.0;\n    if (value !== this._marginX) this._setMarginX(value);\n  }\n  /**\n   * Y 軸方向のひとつ上の兄弟とのマージン。\n   * @type {number}\n   */\n  get marginY() {\n    return this._marginY;\n  }\n  set marginY(value) {\n    if (this !== this.parent._items[0] && value < 0.0) value = 0.0;\n    if (value !== this._marginY) this._setMarginY(value);\n  }\n}\n\n/**\n * 項目一覧の JSON 形式を表します。\n * @typedef ItemsJSON\n * @property {module:mind~ItemJSON[]} items 項目の一覧。\n * @property {boolean} collapsed 折り畳まれているか否か。\n */\n\n/**\n * 項目一覧を表します。\n */\nclass Items {\n  _splice(at, remove, ...add) {\n    const removed = this._items.splice(at, remove, ...add);\n    this.parent.root.session.record(() => this._splice(at, add.length, ...removed));\n    this.parent.modified.next();\n  }\n  _add(at, item) {\n    if (at < this._items.length) {\n      const next = this._items[at];\n      [item.marginY, next.marginY] = [next.marginY, 0.0];\n    }\n    this._splice(at, 0, item);\n  }\n\n  constructor(parent, {items, collapsed} = {}) {\n    /**\n     * 親の実体。\n     * @readonly\n     * @type {!module:mind~Entity}\n     */\n    this.parent = parent;\n    this._items = items ? items.map(x => new Item(this, x)) : [];\n    this._collapsed = !!collapsed;\n  }\n  toJSON() {\n    return this._items.length > 0 ? {\n      items: this._items.map(x => x.toJSON()),\n      collapsed: this._collapsed ? true : undefined\n    } : undefined;\n  }\n  /**\n   * 自身を列挙します。\n   */\n  [Symbol.iterator]() {\n    return this._items[Symbol.iterator]();\n  }\n  /**\n   * at 番目に json の内容で項目を追加します。\n   * @param {number} at 追加先のインデックス。\n   * @param {!module:mind~ItemJSON} [json] 項目の内容。\n   * @returns {!module:mind~Item} 追加された項目。\n   */\n  add(at, json = {}) {\n    const item = new Item(this, json);\n    this._add(at, item);\n    return item;\n  }\n  /**\n   * 折り畳まれているか否か。\n   * @type {boolean}\n   */\n  get collapsed() {\n    return this._collapsed;\n  }\n  set collapsed(value) {\n    if (value === this._collapsed) return;\n    this._collapsed = value;\n    this.parent.modified.next();\n    this.parent.root.session.completed.next();\n  }\n}\n\n/**\n * ルートの JSON 形式を表します。\n * @typedef RootJSON\n * @property {string} text テキスト。\n * @property {number} nextID 次の項目の識別番号。\n * @property {module:mind~ItemsJSON} left 左側のツリー。\n * @property {module:mind~ItemsJSON} right 右側のツリー。\n */\n\n/**\n * ルート(マインドマップ全体)を表します。\n * @extends module:mind~Entity\n */\nexport class Root extends Entity {\n  _setNextID(value) {\n    const old = this._nextID;\n    this.session.record(() => this._setNextID(old));\n    this._nextID = value;\n  }\n  _newID() {\n    const id = this._nextID;\n    this._setNextID(id + 1);\n    return id;\n  }\n\n  /**\n   * ルート(マインドマップ全体)を初期化します。\n   * @param {!module:session.Session} session 操作を管理するセッション。\n   * @param {!module:mind~RootJSON} [json] JSON をデシリアライズした読み込み対象。\n   */\n  constructor(session, {nextID, left, right, ...json} = {}) {\n    super(json);\n    /**\n     * 操作を管理するセッション。\n     * @readonly\n     * @type {!module:session.Session}\n     */\n    this.session = session;\n    this._nextID = nextID || 0;\n    /**\n     * 左側のツリー。\n     * @readonly\n     * @type {!module:mind~Items}\n     */\n    this.left = new Items(this, left);\n    /**\n     * 右側のツリー。\n     * @readonly\n     * @type {!module:mind~Items}\n     */\n    this.right = new Items(this, right);\n  }\n  /**\n   * JSON にシリアライズできるオブジェクトを出力します。\n   * @returns {!module:mind~RootJSON}\n   */\n  toJSON() {\n    return Object.assign(super.toJSON(), {\n      nextID: this._nextID,\n      left: this.left.toJSON(),\n      right: this.right.toJSON()\n    });\n  }\n  get root() {\n    return this;\n  }\n}\n","import { BehaviorSubject } from 'rxjs';\n\n/**\n * マインドマップをレイアウトします。\n * @module mindlayout\n */\n\n/**\n * ルートを含む各項目に共通の実体のレイアウトを表します。\n */\nclass EntityLayout {\n  /**\n   * マインドマップの中心からの絶対位置: [X 座標, Y座標]\n   * @memberof module:mindlayout~EntityLayout\n   * @instance\n   * @readonly\n   * @member {number[]} position\n   */\n\n  constructor(last, model) {\n    /**\n     * 対応するモデル。\n     * @readonly\n     * @type {!module:mind~Entity}\n     */\n    this.model = model;\n    this.subscription = model.modified.subscribe(() => this._dirty());\n    if (last) {\n      /**\n       * 現在の幅。\n       * @readonly\n       * @type {number}\n       */\n      this.width = last.nextWidth;\n      /**\n       * 現在の高さ。\n       * @readonly\n       * @type {number}\n       */\n      this.height = last.nextHeight;\n      /**\n       * フォーカス対象か否かを表すサブジェクト。\n       * @readonly\n       * @type {!module:rxjs.BehaviorSubject}\n       */\n      this.focused = new BehaviorSubject(last.focused.value);\n      /**\n       * アンカー対象か否かを表すサブジェクト。\n       * @readonly\n       * @type {!module:rxjs.BehaviorSubject}\n       */\n      this.anchored = new BehaviorSubject(last.anchored.value);\n      /**\n       * 選択状態か否かを表すサブジェクト。\n       * @readonly\n       * @type {!module:rxjs.BehaviorSubject}\n       */\n      this.selected = new BehaviorSubject(last.selected.value);\n    } else {\n      this.width = this.height = 0.0;\n      this.focused = new BehaviorSubject(false);\n      this.anchored = new BehaviorSubject(false);\n      this.selected = new BehaviorSubject(false);\n    }\n    /**\n     * 次のレイアウトの幅。\n     * @type {number}\n     */\n    this.nextWidth = this.width;\n    /**\n     * 次のレイアウトの高さ。\n     * @type {number}\n     */\n    this.nextHeight = this.height;\n  }\n  /**\n   * 次のレイアウトのサイズを指定します。\n   * @param {number} width 次のレイアウトの幅。\n   * @param {number} height 次のレイアウトの高さ。\n   */\n  nextSize(width, height) {\n    if (width === this.width && height === this.height) return;\n    this.nextWidth = width;\n    this.nextHeight = height;\n    this._dirty();\n  }\n  selectClear() {\n    if (this.selected.value) this.selected.next(false);\n  }\n}\n\n/**\n * ルート以外の項目のレイアウトを表します。\n * @extends module:mindlayout~EntityLayout\n */\nclass ItemLayout extends EntityLayout {\n  _dispose() {\n    this.subscription.unsubscribe();\n    this.children._dispose();\n  }\n  _dirty() {\n    if (this.subscription.closed) return;\n    this.subscription.unsubscribe();\n    this.parent.parent._dirty();\n  }\n  _detach() {\n    this.parent._detach();\n  }\n  _moveX(dx) {\n    let x = this.model.marginX + dx;\n    if (x < 0.0) {\n      this.parent.parent._moveX(x);\n      x = 0.0;\n    }\n    this.model.marginX = x;\n  }\n  _moveUpTop(dy) {\n    dy += this.top - this.children.top;\n    if (dy > 0.0) this.parent._moveUpTop(dy, this);\n  }\n  _moveUpBottom(dy) {\n    dy = this.bottom - Math.max(this.children.bottom - dy, this.height);\n    if (dy > 0.0) this.parent._moveUpBottom(dy, this);\n  }\n  _moveDownTop(dy) {\n    dy = Math.min(this.children.top + dy, 0.0) - this.top;\n    if (dy > 0.0) this.parent._moveDownTop(dy, this);\n  }\n  _moveDownBottom(dy) {\n    dy -= this.bottom - this.children.bottom;\n    if (dy > 0.0) this.parent._moveDownBottom(dy, this);\n  }\n\n  constructor(last, parent, model) {\n    super(last, model);\n    /**\n     * 親の項目一覧のレイアウト。\n     * @readonly\n     * @type {!module:mindlayout~ItemsLayout}\n     */\n    this.parent = parent;\n    /**\n     * 子の項目一覧のレイアウト。\n     * @readonly\n     * @type {!module:mindlayout~ItemsLayout[]}\n     */\n    this.children = new ItemsLayout(last && last.children, this, model.children);\n    /**\n     * 自身を含むツリーの上端。\n     * @readonly\n     * @type {number}\n     */\n    this.top = Math.min(this.children.top, 0.0);\n    /**\n     * 自身を含むツリーの下端。\n     * @readonly\n     * @type {number}\n     */\n    this.bottom = Math.max(this.children.bottom, this.height);\n  }\n  /**\n   * 自身を含むツリーを移動します。\n   * @param {number} dx 移動幅。\n   * @param {number} dy 移動高さ。\n   */\n  move(dx, dy) {\n    if (!this.subscription.closed) this._detach();\n    this._moveX(dx);\n    this.parent._moveY(dy, this);\n  }\n  selectClear() {\n    super.selectClear();\n    this.children._selectClear();\n  }\n  get position() {\n    let [x, y] = [0.0, 0.0];\n    let entity = this;\n    while (true) {\n      x += entity.model.marginX;\n      const parent = entity.parent;\n      y += parent.items[parent.indexOf(entity)].y;\n      entity = parent.parent;\n      if (entity instanceof RootLayout) {\n        x += (entity.width + entity.height) * 0.5;\n        if (parent === entity.left) x = -x - this.width;\n        return [x, y - entity.height * 0.5];\n      }\n      x += entity.width + entity.height;\n    }\n  }\n}\n\n/**\n * 項目一覧のレイアウトを表します。\n */\nclass ItemsLayout {\n  _dispose() {\n    for (const x of this.items.values()) x.item._dispose();\n  }\n  _detach() {\n    for (const x of this.items.values()) x.item.subscription.unsubscribe();\n    this.parent._detach();\n  }\n  __moveUpTop(dy, i) {\n    for (; i > 0; --i) {\n      const item = this.items[i].item.model;\n      if (dy <= item.marginY) {\n        item.marginY -= dy;\n        return;\n      }\n      dy -= item.marginY;\n      item.marginY = 0.0;\n    }\n    this.items[0].item.model.marginY -= dy * 0.5;\n    this.parent._moveUpTop(dy);\n  }\n  _moveUpTop(dy, item) {\n    const i = this.indexOf(item);\n    if (i > 0)\n      this.__moveUpTop(dy, i);\n    else\n      this.parent._moveUpTop(dy);\n  }\n  _moveUpBottom(dy, item) {\n    const i = this.indexOf(item) + 1;\n    if (i < this.items.length)\n      this.items[i].item.model.marginY += dy;\n    else\n      this.parent._moveUpBottom(dy);\n  }\n  _moveDownTop(dy, item) {\n    const i = this.indexOf(item);\n    if (i > 0)\n      this.items[i].item.model.marginY += dy;\n    else\n      this.parent._moveDownTop(dy);\n  }\n  __moveDownBottom(dy, i) {\n    while (++i < this.items.length) {\n      const item = this.items[i].item.model;\n      if (dy <= item.marginY) {\n        item.marginY -= dy;\n        return;\n      }\n      dy -= item.marginY;\n      item.marginY = 0.0;\n    }\n    this.items[0].item.model.marginY += dy * 0.5;\n    this.parent._moveDownBottom(dy);\n  }\n  _moveDownBottom(dy, item) {\n    const i = this.indexOf(item);\n    if (i + 1 < this.items.length)\n      this.__moveDownBottom(dy, i);\n    else\n      this.parent._moveDownBottom(dy);\n  }\n  _moveY(dy, item) {\n    const i = this.indexOf(item);\n    if (dy < 0.0) {\n      dy = -dy;\n      this.__moveUpTop(dy, i);\n      if (i + 1 < this.items.length) {\n        this.items[i + 1].item.model.marginY += dy;\n      } else {\n        this.items[0].item.model.marginY -= dy * 0.5;\n        this.parent._moveUpBottom(dy);\n      }\n    } else if (dy > 0.0) {\n      this.__moveDownBottom(dy, i);\n      if (i > 0) {\n        this.items[i].item.model.marginY += dy;\n      } else {\n        this.items[0].item.model.marginY += dy * 0.5;\n        this.parent._moveDownTop(dy);\n      }\n    }\n  }\n  _selectClear() {\n    if (this.selecteds <= 0) return;\n    for (const x of this.items) x.item.selectClear();\n    this.selecteds = 0;\n  }\n\n  constructor(last, parent, model, x) {\n    /**\n     * 親の実体のレイアウト。\n     * @readonly\n     * @type {!module:mindlayout~EntityLayout}\n     */\n    this.parent = parent;\n    /**\n     * 対応するモデル。\n     * @readonly\n     * @type {!module:mind~Items}\n     */\n    this.model = model;\n    const lasts = last ? new Map(last.items.map(x => [x.item.model, x.item])) : new Map();\n    /**\n     * 項目と Y 座標の一覧。\n     * @readonly\n     * @type {!Array.<{item: module:mindlayout~ItemLayout, y: number}>}\n     */\n    this.items = Array.from(model, model => {\n      let item = lasts.get(model);\n      lasts.delete(model);\n      if (!item || item.subscription.closed)\n        item = new ItemLayout(item, this, model);\n      else\n        item.parent = this;\n      return {item: item, y: model.marginY};\n    });\n    for (const x of lasts.values()) x._dispose();\n    const n = this.items.length;\n    if (n <= 0) {\n      this.top = this.bottom = 0.0;\n    } else if (model.collapsed) {\n      this.top = this.bottom = 0.0;\n      for (const entry of this.items) entry.y = 0.0;\n    } else {\n      let entry = this.items[0];\n      const y0 = entry.y;\n      this.top = y0 + entry.item.top;\n      let i = 0;\n      while (true) {\n        this.bottom = entry.y + entry.item.bottom;\n        if (++i >= n) break;\n        entry = this.items[i];\n        entry.y += this.bottom - entry.item.top;\n      }\n      const dy = (entry.y - y0) * 0.5;\n      /**\n       * 項目一覧の上端。\n       * @readonly\n       * @type {number}\n       */\n      this.top -= dy;\n      /**\n       * 項目一覧の下端。\n       * @readonly\n       * @type {number}\n       */\n      this.bottom -= dy;\n      for (const entry of this.items) entry.y -= dy;\n    }\n    const find = name => {\n      for (const {item} of this.items) {\n        if (item[name].value) return item;\n        const x = item.children[name];\n        if (x) return x;\n      }\n      return null;\n    };\n    /**\n     * 配下のフォーカス対象。\n     * @type {module:mindlayout~ItemLayout}\n     */\n    this.focused = find('focused');\n    /**\n     * 配下のアンカー対象。\n     * @type {module:mindlayout~ItemLayout}\n     */\n    this.anchored = find('anchored');\n    /**\n     * 配下の選択状態の項目数。\n     * @type {number}\n     */\n    this.selecteds = this.items.reduce((n, {item}) => n + (item.selected.value ? 1 : 0) + item.children.selecteds, 0);\n  }\n  /**\n   * item のインデックスを取得します。\n   * @param {!module:mindlayout~ItemLayout} item 取得対象。\n   * @returns {number} item のインデックス。\n   */\n  indexOf(item) {\n    return this.items.findIndex(x => x.item === item);\n  }\n}\n\n/**\n * ルート(マインドマップ全体)のレイアウトを表します。\n * @extends module:mindlayout~EntityLayout\n */\nexport class RootLayout extends EntityLayout {\n  _dirty() {\n    this.subscription.unsubscribe();\n  }\n  _detach() {\n    this.subscription.unsubscribe();\n  }\n  _find(items) {\n    if (items === this.model.left) return this.left;\n    if (items === this.model.right) return this.right;\n    return this.find(items.parent).children;\n  }\n  _moveX(dx) {}\n  _moveUpTop(dy) {}\n  _moveUpBottom(dy) {}\n  _moveDownTop(dy) {}\n  _moveDownBottom(dy) {}\n  * _path(entity) {\n    for (; entity !== this; entity = entity.parent.parent) yield entity;\n  }\n  _getCurrent(name) {\n    return this[name].value ? this : this.left[name] || this.right[name];\n  }\n  _setCurrent(name, entity) {\n    let old = this._getCurrent(name);\n    if (entity === old) return false;\n    if (old) {\n      for (const x of this._path(old)) x.parent[name] = null;\n      old[name].next(false);\n    }\n    if (entity) {\n      for (const x of this._path(entity)) x.parent[name] = entity;\n      entity[name].next(true);\n    }\n    return true;\n  }\n\n  /**\n   * ルート(マインドマップ全体)のレイアウトを計算します。\n   * last がある場合は、有効なサブツリーを引き継ぎます。\n   * @param {!module:mind.Root} model 対応するモデル。\n   * @param {module:mindlayout.RootLayout} [last] 前回のレイアウト。\n   */\n  constructor(model, last = null) {\n    super(last, model);\n    this.left = new ItemsLayout(last && last.left, this, model.left);\n    this.right = new ItemsLayout(last && last.right, this, model.right);\n    this._current = new BehaviorSubject(this._getCurrent('focused'));\n  }\n  /**\n   * 自身を破棄します。\n   * モデルとの接続を切断します。\n   */\n  dispose() {\n    this.subscription.unsubscribe();\n    this.left._dispose();\n    this.right._dispose();\n  }\n  /**\n   * 次のレイアウトを計算します。\n   * 自身が有効な場合は自身を返します。\n   * @returns {!module:mindlayout.RootLayout} 次のレイアウト。\n   */\n  next() {\n    return this.subscription.closed ? new RootLayout(this.model, this) : this;\n  }\n  /**\n   * model に対応するレイアウトを取得します。\n   * @param {!module:mind~Entity} model 対象のモデル。\n   * @returns {!module:mindlayout~EntityLayout} 対応するレイアウト。\n   */\n  find(model) {\n    return model === this.model ? this : this._find(model.parent).items[model.index].item;\n  }\n  /**\n   * 現在の操作対象。\n   * @type {!module:rxjs.BehaviorSubject}\n   */\n  get current() {\n    return this._current;\n  }\n  set current(entity) {\n    if (this._setCurrent('focused', entity)) this._current.next(this._getCurrent('focused'));\n  }\n  /**\n   * アンカー。\n   * @type {module:mindlayout~EntityLayout}\n   */\n  get anchor() {\n    return this._getCurrent('anchored');\n  }\n  set anchor(entity) {\n    this._setCurrent('anchored', entity);\n  }\n  /**\n   * 選択状態を解除します。\n   */\n  selectClear() {\n    super.selectClear();\n    this.left._selectClear();\n    this.right._selectClear();\n  }\n  /**\n   * entity の選択状態を value に設定します。\n   * @param {!module:mindlayout~EntityLayout} entity 対象のレイアウト。\n   * @param {boolean} value 選択状態。\n   */\n  selectSet(entity, value) {\n    if (value === entity.selected.value) return;\n    entity.selected.next(value);\n    const d = value ? 1 : -1;\n    for (const x of this._path(entity)) x.parent.selecteds += d;\n  }\n  /**\n   * first から last までの範囲を選択状態にします。\n   * @param {!module:mindlayout~EntityLayout} first 始点のレイアウト。\n   * @param {!module:mindlayout~EntityLayout} last 終点のレイアウト。\n   */\n  selectRange(first, last) {\n    const path = entity => {\n      const xs = [];\n      for (const x of this._path(entity)) xs.unshift(x);\n      xs.unshift(this);\n      return xs;\n    }\n    let [path0, path1] = [path(first), path(last)];\n    while (path0.length > 1 && path1.length > 1 && path0[1].parent === path1[1].parent) {\n      path0.shift();\n      path1.shift();\n    }\n    const select = (entity, depth) => {\n      this.selectSet(entity, true);\n      if (--depth > 0) for (const x of entity.children.items) select(x.item, depth);\n    };\n    const partial = (path, depth, range) => {\n      while (path.length > 1) {\n        --depth;\n        path.shift();\n        this.selectSet(path[0], true);\n        const items = path[0].parent.items;\n        for (let [i, j] = range(path[0]); i < j; ++i) select(items[i].item, depth);\n      }\n      if (--depth > 0) for (const x of path[0].children.items) select(x.item, depth);\n    };\n    const partial0 = depth => partial(path0, depth, x => [x.parent.indexOf(x) + 1, x.parent.items.length]);\n    const partial1 = depth => partial(path1, depth, x => [0, x.parent.indexOf(x)]);\n    const depth = Math.max(path0.length, path1.length);\n    this.selectSet(path0[0], true);\n    if (path0[0] === this) {\n      if (path0.length > 1 && path1.length > 1 && path0[1].parent === this.right) [path0, path1] = [path1, path0];\n      if (path0.length > 1) partial0(depth);\n      if (path1.length > 1) partial1(depth);\n    } else {\n      const root = path0[0].parent;\n      let [i, j] = [root.indexOf(path0[0]), root.indexOf(path1[0])];\n      if (i === j) {\n        (path0.length > 1 ? partial0 : partial1)(depth);\n      } else {\n        this.selectSet(path1[0], true);\n        if (i > j) [path0, path1, i, j] = [path1, path0, j, i];\n        partial0(depth);\n        while (++i < j) select(root.items[i].item, depth);\n        partial1(depth);\n      }\n    }\n  }\n  get position() {\n    return [-this.width * 0.5, -this.height * 0.5];\n  }\n}\n","import { BehaviorSubject, Subject, of, queueScheduler } from 'rxjs';\nimport { exhaust, map } from 'rxjs/operators';\nimport * as mindlayout from './mind.layout';\nimport {\n  faUndo,\n  faRedo,\n  faPlusSquare,\n  faTrash,\n  faEdit,\n  faArrowsAlt,\n  faCompressArrowsAlt,\n  faExpandArrowsAlt,\n  faCheck,\n  faTimes\n} from '@fortawesome/free-solid-svg-icons';\n\n/**\n * マインドマップのビューモデルを提供します。\n * @module mindview\n */\n\n/**\n * テキストの編集状態を表します。\n * @typedef Editor\n * @property {Function} input 文字入力を処理します。\n * @property {Function} commit 編集を確定します。\n * @property {Function} cancel 編集を取り消します。\n */\n\n/**\n * 主に(マウス)ポインタでの編集操作を表します。\n * @typedef Manipulator\n * @property {Function} end 操作を完了します。\n * @property {Function} move ポインタの移動を処理します。\n */\n\n/**\n * パン操作を表します。\n * @typedef Pan\n * @property {boolean} moved 移動したか否か。\n * @property {Function} move ポインタの移動を処理します。\n */\n\n/**\n * マインドマップのビューモデルです。\n */\nexport class View {\n  _withTransaction(x) {\n    this.begin();\n    try {\n      x();\n    } catch {\n      this.cancel();\n    }\n  }\n  _editorCommitAnd(x) {\n    this.editor.value.commit();\n    x();\n  }\n\n  /**\n   * ビューの状態を初期化します。\n   * @param {!module:mind.Root} model 対象のモデル。\n   */\n  constructor(model) {\n    /**\n     * 対象のモデル。\n     * @readonly\n     * @type {!module:mind.Root}\n     */\n    this.model = model;\n    /**\n     * レイアウトを表すサブジェクト。\n     * @readonly\n     * @type {!module:rxjs.BehaviorSubject}\n     */\n    this.layout = new BehaviorSubject(new mindlayout.RootLayout(model));\n    /**\n     * ビューポートの位置を表すサブジェクト。\n     * @readonly\n     * @type {!module:rxjs.BehaviorSubject}\n     */\n    this.translate = new BehaviorSubject({x: 0.0, y: 0.0});\n    /**\n     * ビューポートの拡大率を表すサブジェクト。\n     * @readonly\n     * @type {!module:rxjs.BehaviorSubject}\n     */\n    this.scale = new BehaviorSubject(1.0);\n    /**\n     * 既定のテキスト編集状態。\n     * @readonly\n     * @type {!module:mindview~Editor}\n     */\n    this.editorDefault = {\n      input: value => {\n        const model = this.layout.value.current.value.model;\n        const text = model.text;\n        this.begin();\n        model.text = value;\n        this.editor.next({\n          input: value => {\n            this.cancel();\n            this.begin();\n            model.text = value;\n            this.model.session.completed.next();\n          },\n          commit: () => {\n            this.editor.next(this.editorDefault);\n            if (model.text === text)\n              this.cancel();\n            else\n              this.commit('Edit');\n          },\n          cancel: () => {\n            this.editor.next(this.editorDefault);\n            this.cancel();\n          }\n        });\n        this.model.session.completed.next();\n      },\n      commit: () => {},\n      cancel: () => {}\n    };\n    /**\n     * テキストの編集状態を表すサブジェクト。\n     * @readonly\n     * @type {!module:rxjs.BehaviorSubject}\n     */\n    this.editor = new BehaviorSubject(this.editorDefault);\n    const session = this.model.session;\n    const undos = session.undos;\n    const redos = session.redos;\n    const menu = () => [\n      [`Undo${undos.length > 0 ? ` - ${undos[undos.length - 1].message}` : ''}`, faUndo, undos.length > 0 ? () => this._editorCommitAnd(() => session.undo()) : null],\n      [`Redo${redos.length > 0 ? ` - ${redos[redos.length - 1].message}` : ''}`, faRedo, redos.length > 0 ? () => this._editorCommitAnd(() => session.redo()) : null]\n    ];\n    /**\n     * メニューを表すサブジェクト。\n     * @readonly\n     * @type {!module:rxjs.BehaviorSubject}\n     */\n    this.menu = new BehaviorSubject(menu());\n    const manipulator = () => {\n      if (this.editor.value !== this.editorDefault) return [[\n        ['Cancel (Esc)', faTimes, () => this.editor.value.cancel()]\n      ], [], [\n        ['Commit (Enter)', faCheck, () => this.editor.value.commit()]\n      ], [], [], [], [], []];\n      const root = this.layout.value;\n      if (!root.current.value) return [[], [], [], [], [], [], [], []];\n      const edit = () => this._editorCommitAnd(() => this.editor.value.input(this.layout.value.current.value.model.text));\n      const collapse = (model, name) => model.collapsed\n        ? [`Expand ${name}`, faExpandArrowsAlt, () => this._editorCommitAnd(() => model.collapsed = false)]\n        : [`Collapse ${name}`, faCompressArrowsAlt, () => this._editorCommitAnd(() => model.collapsed = true)];\n      if (root.current.value === root) return [[], [], [\n          ['Edit', faEdit, edit]\n        ], root.right.items.length > 0 ? [\n          collapse(root.model.right, 'Right Items')\n        ] : [\n          ['Add Right', faPlusSquare, () => this._editorCommitAnd(() => this._withTransaction(() => {\n            this.selectByModel(this.layout.value.model.right.add(0, {text: 'Right'}));\n            this.commit('Add right');\n          }))]\n        ], [], [], [], root.left.items.length > 0 ? [\n          collapse(root.model.left, 'Left Items')\n        ] : [\n          ['Add Left', faPlusSquare, () => this._editorCommitAnd(() => this._withTransaction(() => {\n            this.selectByModel(this.layout.value.model.left.add(0, {text: 'Left'}));\n            this.commit('Add left');\n          }))]\n        ]\n      ];\n      const menus = [[], [\n          ['Add Above', faPlusSquare, () => this._editorCommitAnd(() => this._withTransaction(() => {\n            let model = this.layout.value.current.value.model;\n            this.selectByModel(model.parent.add(model.index, {text: 'Above'}));\n            this.commit('Add item above');\n          }))]\n        ], [\n          ['Edit', faEdit, edit]\n        ], root.current.value.children.items.length > 0 ? [\n          collapse(root.current.value.model.children, 'Children')\n        ] : [\n          ['Add Child', faPlusSquare, () => this._editorCommitAnd(() => this._withTransaction(() => {\n            this.selectByModel(this.layout.value.current.value.model.children.add(0, {text: 'Child'}));\n            this.commit('Add child');\n          }))]\n        ], [], [\n          ['Add Below', faPlusSquare, () => this._editorCommitAnd(() => this._withTransaction(() => {\n            let model = this.layout.value.current.value.model;\n            this.selectByModel(model.parent.add(model.index + 1, {text: 'Below'}));\n            this.commit('Add item below');\n          }))]\n        ], [\n          ['Delete', faTrash, () => this._editorCommitAnd(() => this._withTransaction(() => {\n            const remove = items => {\n              if (items.selecteds <= 0) return;\n              for (const {item} of items.items)\n                if (item.selected.value)\n                  item.model.remove();\n                else\n                  remove(item.children);\n            };\n            const root = this.layout.value;\n            remove(root.left);\n            remove(root.right);\n            this.commit('Delete items');\n          }))]\n        ], [\n          ['Move Elsewhere', faArrowsAlt, () => this.moveElsewhere(this.layout.value.current.value)]\n        ]\n      ];\n      let tree = root.current.value.parent;\n      while (tree.parent !== root) tree = tree.parent.parent;\n      return tree === root.left ? [menus[2], menus[1], menus[0], menus[7], menus[6], menus[5], menus[4], menus[3]] : menus;\n    };\n    /**\n     * マニピュレータを表すサブジェクト。\n     * @readonly\n     * @type {!module:rxjs.BehaviorSubject}\n     */\n    this.manipulator = new BehaviorSubject(manipulator());\n    this._kick = new Subject();\n    this._kick.pipe(map(() => of(null, queueScheduler)), exhaust()).subscribe(() => {\n      this.menu.next(menu());\n      this.manipulator.next(manipulator());\n    });\n    this.completed = session.completed.subscribe(() => {\n      this.next();\n      this._kick.next();\n    });\n  }\n  /**\n   * 自身を破棄します。\n   * モデルとの接続を切断します。\n   */\n  dispose() {\n    this.completed.unsubscribe();\n    this.layout.value.dispose();\n  }\n  /**\n   * 必要なら次のレイアウトを計算します。\n   */\n  next() {\n    const root = this.layout.value;\n    const next = root.next();\n    if (next !== root) this.layout.next(next);\n  }\n  /**\n   * トランザクションを開始します。\n   */\n  begin() {\n    this.model.session.begin();\n  }\n  /**\n   * トランザクションを確定します。\n   * @param {string} x メッセージ。\n   */\n  commit(x) {\n    this.model.session.commit(x);\n  }\n  /**\n   * トランザクションを中止します。\n   */\n  cancel() {\n    this.model.session.cancel();\n  }\n  /**\n   * entity の選択状態を変更します。\n   * @param {!module:mindlayout~EntityLayout} entity 対象のレイアウト。\n   * @param {boolean} shift Shift キーが押下されているか否か。\n   * @param {boolean} control Ctrl キーが押下されているか否か。\n   */\n  select(entity, shift, control) {\n    const root = this.layout.value;\n    root.current = entity;\n    if (shift) {\n      if (!root.anchor) root.anchor = entity;\n      if (!control) root.selectClear();\n      root.selectRange(root.anchor, entity);\n    } else {\n      root.anchor = entity;\n      if (control) {\n        root.selectSet(entity, !entity.selected.value);\n      } else if (!entity.selected.value) {\n        root.selectClear();\n        root.selectSet(entity, true);\n      }\n    }\n    this._kick.next();\n  }\n  /**\n   * すべての選択状態を解除します。\n   */\n  selectClear() {\n    const root = this.layout.value;\n    root.current = root.anchor = null;\n    root.selectClear();\n    this._kick.next();\n  }\n  /**\n   * モデルで指定して選択します。\n   * @param {!module:mind~Entity} model 対象のモデル。\n   */\n  selectByModel(model) {\n    this.next();\n    const root = this.layout.value;\n    const entity = root.find(model);\n    root.current = root.anchor = entity;\n    root.selectClear();\n    root.selectSet(entity, true);\n    this._kick.next();\n  }\n  /**\n   * ビューポートのパン操作を開始します。\n   * @param {number} x0 開始時点のポインタの X 座標。\n   * @param {number} y0 開始時点のポインタの Y 座標。\n   * @returns {!module:mindview~Pan} パン操作のマニピュレータ。\n   */\n  pan(x0, y0) {\n    const {x, y} = this.translate.value;\n    const pan = {\n      moved: false,\n      move: (x1, y1) => {\n        this.translate.next({x: x - x0 + x1, y: y - y0 + y1});\n        pan.moved = true;\n      }\n    };\n    return pan;\n  }\n  /**\n   * ビューポートを拡大縮小します。\n   * @param {number} cx 拡大縮小の中心の X 座標。\n   * @param {number} cy 拡大縮小の中心の Y 座標。\n   * @param {number} ratio 拡大縮小の変化率。\n   */\n  zoom(cx, cy, ratio) {\n    const s0 = this.scale.value;\n    const s1 = Math.min(Math.max(s0 * ratio, 0.125), 4.0);\n    const r = s1 / s0;\n    const {x, y} = this.translate.value;\n    this.translate.next({x: cx + (x - cx) * r, y: cy + (y - cy) * r});\n    this.scale.next(s1);\n  }\n  /**\n   * item の位置の調整操作を開始します。\n   * @param {!module:mindlayout~ItemLayout} item 移動対象の項目。\n   * @param {number} x0 開始時点のポインタの X 座標。\n   * @param {number} y0 開始時点のポインタの Y 座標。\n   * @returns {!module:mindview~Manipulator} 調整操作のマニピュレータ。\n   */\n  move(item, x0, y0) {\n    this.editor.value.commit();\n    let [dx, dy] = [0.0, 0.0];\n    this.begin();\n    return {\n      end: () => {\n        if (dx === 0.0 && dy === 0.0)\n          this.cancel();\n        else\n          this.commit('Move item');\n      },\n      move: (x1, y1) => {\n        this.cancel();\n        this.begin();\n        [dx, dy] = [x1 - x0, y1 - y0];\n        const s = this.scale.value;\n        item.move(dx / s, dy / s);\n        this.model.session.completed.next();\n      }\n    };\n  }\n  /**\n   * item のツリー内での移動操作を開始します。\n   * @param {!module:mindlayout~ItemLayout} item 移動対象の項目。\n   * @returns {!module:mindview~Manipulator} 移動操作のマニピュレータ。\n   */\n  moveElsewhere(item) {\n    this.editor.value.commit();\n    let found;\n    return {\n      end: () => {\n        const [items, at] = found;\n        const i = item.model.index;\n        if (items === item.parent && (at === i || at === i + 1)) return;\n        this._withTransaction(() => {\n          item.model.moveInto(items.model, at);\n          this.selectByModel(item.model);\n          this.commit('Move item elsewhere');\n        });\n      },\n      move: (x, y) => {\n        const find = (items, cx, cy, dy) => {\n          const n = items.items.length;\n          if (n <= 0) return [items, 0, cx, cy, dy];\n          items.model.collapsed = false;\n          let last = items.items[0];\n          let i = 0;\n          do {\n            const entry = items.items[i];\n            const yy = cy + entry.y;\n            if (yy + entry.item.top > y) break;\n            last = entry;\n            if (yy + entry.item.height * 0.5 > y) break;\n          } while (++i < n);\n          if (last.item === item) return [items, i, cx, cy, dy];\n          const xx = cx + dy + last.item.model.marginX + last.item.width;\n          return xx > x ? [items, i, cx, cy, dy] : find(last.item.children, xx, cy + last.y, last.item.height);\n        };\n        const t = this.translate.value;\n        const s = this.scale.value;\n        const root = this.layout.value;\n        [x, y] = [(x - t.x) / s, (y - t.y) / s + root.height * 0.5];\n        const direction = x > 0.0 ? 1.0 : -1.0;\n        x *= direction;\n        let [items, at, cx, cy, dy] = found = find(direction > 0.0 ? root.right : root.left, root.width * 0.5, 0.0, root.height * 0.5);\n        cy -= root.height * 0.5;\n        const n = items.items.length;\n        const yy = n > 0 ? (x => x.y + x.item[at < n ? 'top' : 'bottom'] + x.item.height * 0.25)(items.items[at < n ? at : n - 1]) : dy;\n        return `M ${cx * direction},${cy + dy} C ${(cx + dy * 0.5) * direction},${cy + dy} ${cx * direction},${cy + yy} ${(cx + dy) * direction},${cy + yy} a ${dy * 0.25} ${dy * 0.25} 0 0 0 ${dy * direction * 0.5} 0 a ${dy * 0.25} ${dy * 0.25} 0 0 0 ${dy * direction * -0.5} 0`;\n      },\n    };\n  }\n}\n","import React, { useState, useEffect, useContext, useRef, useLayoutEffect } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport './MindMap.css';\n\n/**\n * マインドマップの React コンポーネントを提供します。\n * @module MindMap\n */\n\n/**\n * @file\n * @example\n * import Session from './session';\n * import * as mind from './mind';\n * import * as mindview from './mind.view';\n * import { MindMapContext, MindMap } from './MindMap';\n * import React, { useState, useEffect, useRef } from 'react';\n *\n * function App() {\n *   const [model, setModel] = useState(() => new mind.Root(new Session()));\n *   const contextRef = useRef();\n *   // setModel で別のモデルに切り替えると、ビューモデルもつくりなおされる。\n *   useEffect(() => {\n *     const view = new mindview.View(model);\n *     contextRef.current = view;\n *     return () => view.dispose();\n *   }, [model]);\n *   return (\n *     <div className=\"App\">\n *       {contextRef.current && (\n *         <MindMapContext.Provider value={contextRef.current}>\n *           <MindMap />\n *         </MindMapContext.Provider>\n *       )}\n *     </div>\n *   );\n * }\n */\n\n/**\n * マニピュレータ操作に対応した React コンポーネントです。\n * @function\n * @param {!Object} _\n * @param {string} _.cursor 既定のカーソル。\n * @param {Function} _.onPointerDown ポインタ押下時の処理。\n * @param {Object} _.children 子コンポーネント。\n * @param {Object} _.props 残りのプロパティ。\n * @returns {!Object} レンダリング結果。\n */\nconst Manipulatee = React.forwardRef(({cursor, onPointerDown, children, ...props}, ref) => {\n  const [manipulator, setManipulator] = useState(null);\n  return (\n    <div ref={ref}\n      style={{cursor: manipulator ? manipulator.cursor : cursor}}\n      onPointerDown={e => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (manipulator) return;\n        e.currentTarget.setPointerCapture(e.pointerId);\n        setManipulator(onPointerDown(e));\n      }}\n      onPointerUp={e => {\n        e.stopPropagation();\n        e.currentTarget.releasePointerCapture(e.pointerId);\n        if (manipulator) {\n          manipulator.onPointerUp(e);\n          setManipulator(null);\n        }\n      }}\n      onPointerMove={e => {\n        e.stopPropagation();\n        if (manipulator) manipulator.onPointerMove(e);\n      }}\n      {...props}\n    >{children}</div>\n  );\n});\n\n/**\n * ビューモデルを格納する React コンテキスト。\n */\nexport const MindMapContext = React.createContext();\n\n/**\n * 実体のレイアウトに共通の振る舞いを提供する React Hook 。\n * @param {!module:mindlayout~EntityLayout} entity レイアウト。\n * @returns {!Array} [選択状態か否か, React コンポーネントに指定する Ref, テキスト部分のレンダリング結果]\n */\nfunction useEntity(entity) {\n  const [focused, setFocused] = useState(entity.focused.value);\n  const [selected, setSelected] = useState(entity.selected.value);\n  const ref = useRef();\n  useLayoutEffect(() => {\n    entity.nextSize(ref.current.offsetWidth, ref.current.offsetHeight);\n    const subscription = entity.focused.subscribe(setFocused);\n    subscription.add(entity.selected.subscribe(setSelected));\n    return () => subscription.unsubscribe();\n  }, [entity]);\n  const context = useContext(MindMapContext);\n  const [editor, setEditor] = useState(focused && context.editor.value);\n  const inputRef = useRef();\n  useLayoutEffect(() => {\n    if (focused) {\n      inputRef.current.focus();\n      const subscription = context.editor.subscribe(setEditor);\n      return () => subscription.unsubscribe();\n    } else {\n      setEditor(null);\n    }\n  }, [context, entity, focused]);\n  useLayoutEffect(() => {\n    if (!inputRef.current) return;\n    if (editor === context.editorDefault) {\n      inputRef.current.innerText = '';\n    } else if (entity.model.text !== inputRef.current.innerText) {\n      inputRef.current.innerText = entity.model.text;\n      const selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.selectAllChildren(inputRef.current);\n    }\n  }, [context, entity, editor]);\n  return [selected, ref, focused ? (\n    <div style={{position: 'relative'}}>\n      {entity.model.text}\n      <div ref={inputRef} contentEditable\n        className={`MindMap-input${editor === context.editorDefault ? '' : ' active'}`}\n        onInput={e => context.editor.value.input(e.target.innerText)}\n        onBlur={e => context.editor.value.commit()}\n        onKeyDown={e => {\n          switch (e.key) {\n            case 'Enter':\n              context.editor.value.commit();\n              break;\n            case 'Escape':\n              context.editor.value.cancel();\n              break;\n            default:\n              return;\n          }\n          e.preventDefault();\n          e.stopPropagation();\n        }}\n        onPointerDown={e => e.stopPropagation()}\n      />\n    </div>\n  ) : entity.model.text];\n}\n\n/**\n * 項目のレイアウトに対応する React コンポーネント。\n * @param {!Object} _\n * @param {!module:mindlayout~ItemLayout} _.item 項目のレイアウト。\n * @param {number} _.direction X 軸方向の符号。\n * @returns {!Object} レンダリング結果。\n */\nfunction Item({item, direction}) {\n  const context = useContext(MindMapContext);\n  const [selected, ref, text] = useEntity(item);\n  return (\n    <div style={{transform: `translateX(${direction < 0 ? -item.width : 0}px)`}}>\n      <Manipulatee ref={ref}\n        className={`MindMap-item${selected ? ' selected' : ''}`}\n        onPointerDown={e => {\n          context.select(item, e.shiftKey, e.ctrlKey);\n          const move = context.move(item, e.clientX * direction, e.clientY);\n          return {\n            cursor: 'grabbing',\n            onPointerUp: () => move.end(),\n            onPointerMove: e => move.move(e.clientX * direction, e.clientY)\n          };\n        }}\n      >{text}</Manipulatee>\n      <div style={{transform: `translateX(${direction < 0 ? 0 : item.width}px)`}}>\n        <Items items={item.children} direction={direction} dy={item.height} />\n      </div>\n    </div>\n  );\n}\n\n/**\n * 項目一覧のレイアウトに対応する React コンポーネント。\n * @param {!Object} _\n * @param {!module:mindlayout~ItemsLayout} _.items 項目一覧のレイアウト。\n * @param {number} _.direction X 軸方向の符号。\n * @param {number} _.dy Y 軸方向の移動量。\n * @returns {!Object} レンダリング結果。\n */\nfunction Items({items, direction, dy}) {\n  return items.items.length <= 0 ? null : items.model.collapsed ? (\n    <span className=\"MindMap-collapsed\" onPointerDown={e => e.stopPropagation()} onClick={() => items.model.collapsed = false} title=\"Expand\">\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1 1\">\n        <path d={`M 0,${dy} h ${dy * direction * 0.25} a ${dy * 0.25} ${dy * 0.25} 0 0 0 ${dy * direction * 0.5} 0 a ${dy * 0.25} ${dy * 0.25} 0 0 0 ${dy * direction * -0.5} 0`} />\n      </svg>\n    </span>\n  ) : (\n    <>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1 1\">\n        {items.items.map(({y, item}) => (\n          <path key={item.model.id} className=\"line\" d={`M 0,${dy} C ${dy * direction * 0.5},${dy} 0,${y + item.height} ${dy * direction},${y + item.height} h ${(item.model.marginX + item.width) * direction}`} />\n        ))}\n      </svg>\n      {items.items.map(({y, item}) => (\n        <div key={item.model.id} style={{transform: `translate(${(dy + item.model.marginX) * direction}px, ${y}px)`}}>\n          <Item item={item} direction={direction} />\n        </div>\n      ))}\n    </>\n  );\n}\n\n/**\n * メニューに対応する React コンポーネント。\n * @param {!Object} _\n * @param {!Array.<{name: string, icon: Object, action: Function}>} _.items メニュー項目の一覧。\n * @returns {!Object} レンダリング結果。\n */\nexport function Menu({items}) {\n  return (\n    <>\n      {items.map(([name, icon, action], i) => (\n        <div key={i} className={action ? '' : 'disabled'} title={name}\n          onPointerDown={e => {\n            e.preventDefault();\n            if (action) {\n              e.manipulator = action();\n              if (e.manipulator) return;\n            }\n            e.stopPropagation();\n          }}\n        ><FontAwesomeIcon icon={icon} fixedWidth /></div>\n      ))}\n    </>\n  );\n}\n\n/**\n * マインドマップ全体に対応する React コンポーネント。\n * @returns {!Object} レンダリング結果。\n */\nexport function MindMap() {\n  const context = useContext(MindMapContext);\n  const [root, setRoot] = useState(context.layout.value);\n  const [current, setCurrent] = useState(root.current.value);\n  const [translate, setTranslate] = useState(context.translate.value);\n  const [scale, setScale] = useState(context.scale.value);\n  const [menus, setMenus] = useState(context.manipulator.value);\n  useEffect(() => {\n    const subscription = context.layout.subscribe(x => {\n      setRoot(x);\n      setCurrent(x.current.value);\n    });\n    subscription.add(context.translate.subscribe(setTranslate));\n    subscription.add(context.scale.subscribe(setScale));\n    subscription.add(context.manipulator.subscribe(setMenus));\n    return () => subscription.unsubscribe();\n  }, [context]);\n  useEffect(() => {\n    const subscription = root.current.subscribe(setCurrent);\n    return () => subscription.unsubscribe();\n  }, [root]);\n  const [selected, rootRef, text] = useEntity(root);\n  useLayoutEffect(() => context.next());\n  const [viewport, setViewport] = useState({left: 0.0, top: 0.0, width: 0.0, height: 0.0});\n  const viewportRef = useRef();\n  useEffect(() => {\n    const observer = new ResizeObserver(() => setViewport(viewportRef.current.getBoundingClientRect()));\n    observer.observe(viewportRef.current);\n    return () => observer.disconnect();\n  }, []);\n  const [indicator, setIndicator] = useState();\n  const menuRef0 = useRef();\n  const menuRef1 = useRef();\n  const menuRef2 = useRef();\n  const menuRef3 = useRef();\n  const menuRef4 = useRef();\n  const menuRef5 = useRef();\n  const menuRef6 = useRef();\n  const menuRef7 = useRef();\n  const [menuTransforms, setMenuTransforms] = useState([]);\n  useLayoutEffect(() => {\n    if (!current || indicator) return;\n    let [x, y, width, height] = [...current.position, current.width, current.height].map(x => x * scale);\n    x += translate.x + viewport.width * 0.5;\n    y += translate.y + viewport.height * 0.5;\n    setMenuTransforms([\n      [menuRef0, 0.0, 0.0, 1.0, 1.0],\n      [menuRef1, 0.5, 0.0, 0.5, 1.0],\n      [menuRef2, 1.0, 0.0, 0.0, 1.0],\n      [menuRef3, 1.0, 0.5, 0.0, 0.5],\n      [menuRef4, 1.0, 1.0, 0.0, 0.0],\n      [menuRef5, 0.5, 1.0, 0.5, 0.0],\n      [menuRef6, 0.0, 1.0, 1.0, 0.0],\n      [menuRef7, 0.0, 0.5, 1.0, 0.5]\n    ].map(([ref, sx, sy, mx, my], i) => {\n      const menu = ref.current.getBoundingClientRect();\n      return `translate(${x + width * sx - menu.width * mx}px, ${y + height * sy - menu.height * my}px)`;\n    }));\n  }, [root, current, translate, scale, menus, viewport, indicator]);\n  return (\n    <Manipulatee ref={viewportRef} className=\"MindMap-viewport\" cursor=\"grab\"\n      onPointerDown={e => {\n        const manipulator = e.manipulator;\n        if (manipulator) {\n          e.manipulator = null;\n          setIndicator(manipulator.move(e.clientX - viewport.width * 0.5, e.clientY - viewport.height * 0.5));\n          return {\n            cursor: 'grabbing',\n            onPointerUp: () => {\n              setIndicator(null);\n              manipulator.end();\n            },\n            onPointerMove: e => setIndicator(manipulator.move(e.clientX - viewport.width * 0.5, e.clientY - viewport.height * 0.5))\n          };\n        }\n        const pan = context.pan(e.clientX, e.clientY);\n        const clear = e.target === viewportRef.current;\n        return {\n          cursor: 'grabbing',\n          onPointerUp: e => {\n            if (pan.moved) return;\n            context.editor.value.commit();\n            if (clear) context.selectClear();\n          },\n          onPointerMove: e => pan.move(e.clientX, e.clientY)\n        };\n      }}\n      onWheel={e => context.zoom(\n        e.clientX - viewport.left - viewport.width * 0.5,\n        e.clientY - viewport.top - viewport.height * 0.5,\n        1.0 - e.deltaY / 256.0\n      )}\n      onScroll={e => {\n        context.translate.next({\n          x: translate.x - e.target.scrollLeft,\n          y: translate.y - e.target.scrollTop\n        });\n        e.target.scroll(0, 0);\n      }}\n    >\n      <div className=\"MindMap-content\" style={{\n        transformOrigin: `${viewport.width * 0.5}px ${viewport.height * 0.5}px`,\n        transform: `translate(${translate.x}px, ${translate.y}px) scale(${scale}) translate(${viewport.width * 0.5}px, ${viewport.height * 0.5}px)`\n      }}>\n        <div style={{transform: `translate(${root.width * -0.5}px, ${root.height * -0.5}px)`}}>\n          <div ref={rootRef}\n            className={`MindMap-root${selected ? ' selected' : ''}`}\n            onPointerDown={e => context.select(root, e.shiftKey, e.ctrlKey)}\n          >{text}</div>\n          <Items items={root.left} direction={-1} dy={root.height * 0.5} />\n          <div style={{transform: `translateX(${root.width}px)`}}>\n            <Items items={root.right} direction={1} dy={root.height * 0.5} />\n          </div>\n        </div>\n        {indicator && (\n          <svg className=\"MindMap-indicator\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1 1\">\n            <path d={indicator} />\n          </svg>\n        )}\n      </div>\n      {!indicator && [menuRef0, menuRef1, menuRef2, menuRef3, menuRef4, menuRef5, menuRef6, menuRef7].map((ref, i) => (\n        <div key={i} ref={ref} className=\"MindMap-manipulator Menu\" style={{transform: menuTransforms[i]}}>\n          <Menu items={menus[i]} />\n        </div>\n      ))}\n    </Manipulatee>\n  );\n}\n","import Session from './session';\nimport * as mind from './mind';\nimport * as mindview from './mind.view';\nimport { faFile, faCloudDownloadAlt, faCloudUploadAlt, faFileUpload, faFileDownload } from '@fortawesome/free-solid-svg-icons';\nimport { MindMapContext, MindMap, Menu } from './MindMap';\nimport React, { useState, useEffect, useLayoutEffect, useRef } from 'react';\nimport './App.css';\n\nfunction App() {\n  const [model, setModel] = useState();\n  const [fileID, setFileID] = useState();\n  const navigate = x => {\n    window.history.replaceState(null, '', window.location.origin + window.location.pathname + x);\n    setFileID(null);\n  }\n  useLayoutEffect(() => {\n    (async () => {\n      const gapi = await window.GAPI();\n      const [action, id] = gapi.parseState();\n      switch (action) {\n        case 'open':\n          if (id !== fileID) {\n            setModel(new mind.Root(new Session(), JSON.parse(await gapi.download(id))));\n            setFileID(id);\n          }\n          break;\n        default:\n          if (!(fileID === '')) {\n            setModel(new mind.Root(new Session(), {text: '新しいマインドマップ'}));\n            setFileID('');\n          }\n      }\n    })();\n  }, [fileID]);\n  const [view, setView] = useState();\n  useLayoutEffect(() => {\n    setView(model ? new mindview.View(model) : null);\n  }, [model]);\n  useLayoutEffect(() => view ? () => view.dispose() : undefined, [view]);\n  const uploadRef = useRef();\n  const downloadRef = useRef();\n  const [menu, setMenu] = useState([]);\n  useEffect(() => {\n    if (!view) return;\n    const subscription = view.menu.subscribe(menu => setMenu([\n      ['New', faFile, () => navigate('')],\n      ['Open', faCloudDownloadAlt, () => {\n        view.editor.value.commit();\n        (async () => {\n          const gapi = await window.GAPI();\n          const id = await gapi.pickFile();\n          if (id) navigate(gapi.buildState(id));\n        })();\n      }],\n      ['Save', faCloudUploadAlt, () => {\n        view.editor.value.commit();\n        (async () => {\n          const gapi = await window.GAPI();\n          const json = JSON.stringify(model.toJSON(), null, '  ');\n          if (fileID) {\n            await gapi.update(fileID, json);\n          } else {\n            const [action, id] = gapi.parseState();\n            const folderID = action === 'create' ? id : await gapi.pickFolder();\n            if (!folderID) return;\n            const fileID = await gapi.create(folderID, json);\n            navigate(gapi.buildState(fileID));\n            setFileID(fileID);\n          }\n        })();\n      }],\n      ...menu,\n      ['Upload', faFileUpload, () => {\n        view.editor.value.commit();\n        uploadRef.current.click();\n      }],\n      ['Download', faFileDownload, () => {\n        view.editor.value.commit();\n        downloadRef.current.click();\n      }]\n    ]));\n    return () => subscription.unsubscribe();\n  }, [model, fileID, view]);\n  return (\n    <div className=\"App\">\n      <input ref={uploadRef} type=\"file\" style={{display: 'none'}} onChange={async e => {\n        const target = e.target;\n        setModel(new mind.Root(new Session(), JSON.parse(await target.files[0].text())));\n        target.value = '';\n      }} />\n      <a ref={downloadRef} href=\" \" download style={{display: 'none'}} onClick={e => {\n        e.target.href = 'data:application/json,' + encodeURIComponent(JSON.stringify(model.toJSON(), null, '  '));\n      }}> </a>\n      {view && (\n        <MindMapContext.Provider value={view}>\n          <MindMap />\n        </MindMapContext.Provider>\n      )}\n      <div className=\"Menu\">\n        <Menu items={menu} />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}